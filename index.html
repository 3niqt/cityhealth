<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>City Health Office</title>
  <style>
    body { margin: 0; font-family: Arial, sans-serif; }
    header { background: #fdd835; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; }
    header h1 { color: #0d47a1; font-size: 24px; margin: 0; }
    nav a { margin-left: 20px; text-decoration: none; font-weight: bold; color: black; }
    nav a:hover { color: #0d47a1; }
    .appointment-btn { padding: 10px 20px; margin: 20px auto; display: block; border: 2px solid #0d47a1; border-radius: 20px; background: white; color: #0d47a1; font-weight: bold; cursor: pointer; }
    .appointment-btn:hover { background: #0d47a1; color: white; }
    .modal { display: none; position: fixed; z-index: 1000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
    .modal-content { background: white; padding: 30px; border-radius: 15px; width: 500px; max-width: 95%; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    .modal-content h2 { color: #999; margin-bottom: 20px; }
    .close { float: right; cursor: pointer; font-size: 20px; font-weight: bold; color: #555; }
    .role-btn { display: block; width: 100%; padding: 12px; margin: 10px 0; border: 2px solid #0d47a1; border-radius: 20px; background: white; color: #0d47a1; font-weight: bold; cursor: pointer; }
    .role-btn:hover { background: #0d47a1; color: white; }
    form { text-align: left; }
    label { display: block; margin: 8px 0 4px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-bottom: 15px; }
    .privacy { font-size: 12px; color: gray; margin-bottom: 10px; }
    .submit-btn { width: 100%; padding: 12px; border: none; border-radius: 20px; background: #0d47a1; color: white; font-weight: bold; cursor: pointer; }
    .submit-btn:hover { background: #002171; }
    #adminDashboard { display: none; padding: 20px; }
    #adminDashboard h2 { margin-bottom: 20px; color: #0d47a1; }
    .filters { margin-bottom: 15px; }
    .filters input, .filters select { padding: 8px; margin-right: 10px; }
    table { width: 100%; border-collapse: collapse; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: left; }
    th { background: #fdd835; }
  </style>
</head>
<body>

  <header>
    <h1>CITY HEALTH OFFICE</h1>
    <nav>
      <a href="#">HOME</a>
      <a href="#">ABOUT</a>
      <a href="#">SERVICES</a>
      <a href="#">CONTACT</a>
    </nav>
  </header>

  <button class="appointment-btn" id="appointmentBtn">APPOINTMENT</button>

  <!-- Role Modal -->
  <div id="roleModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('roleModal')">&times;</span>
      <h2>Select Your Role</h2>
      <button class="role-btn" onclick="openModal('clientModal')">CLIENT</button>
      <button class="role-btn" onclick="openModal('adminModal')">ADMIN</button>
    </div>
  </div>

  <!-- Client Modal -->
  <div id="clientModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('clientModal')">&times;</span>
      <h2>Client Appointment Form</h2>
      <form id="clientForm">
        <label>Name</label>
        <input type="text" id="clientName" required>
        <label>Age</label>
        <input type="number" id="clientAge" required>
        <label>Email</label>
        <input type="email" id="clientEmail" required>
        <label>Category</label>
        <select id="clientCategory" required>
          <option value="">-- Select Health Center --</option>
          <option value="Consultation">Tunasan Health Center</option>
          <option value="Vaccination">Poblacion Health Center</option>
          <option value="Check-up">Putatan Health Center</option>
          <option value="Check-up">Bayanan Health Center</option>
          <option value="Vaccination">Alabang Health Center</option>
        </select>
        <label>Purpose</label>
        <textarea id="clientPurpose" rows="3" required></textarea>
        <p class="privacy">By submitting this form, you agree that your data will be used for appointment scheduling purposes in compliance with the Data Privacy Act.</p>
        <button type="submit" class="submit-btn">Submit</button>
      </form>
    </div>
  </div>

  <!-- Admin Modal -->
  <div id="adminModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal('adminModal')">&times;</span>
      <h2>Admin Login</h2>
      <form id="adminLoginForm">
        <label>Username</label>
        <input type="text" id="adminUser" required>
        <label>Password</label>
        <input type="password" id="adminPass" required>
        <button type="submit" class="submit-btn">Login</button>
      </form>
    </div>
  </div>

  <!-- Admin Dashboard -->
  <div id="adminDashboard">
    <h2>Client Appointments</h2>
    <div class="filters">
      <input type="text" id="searchBar" placeholder="Search by name, email or purpose">
      <input type="date" id="filterDate">
      <select id="filterCategory">
        <option value="">All Categories</option>
        <option value="Consultation">Consultation</option>
        <option value="Vaccination">Vaccination</option>
        <option value="Check-up">Check-up</option>
      </select>
    </div>
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Name</th>
          <th>Age</th>
          <th>Email</th>
          <th>Category</th>
          <th>Purpose</th>
        </tr>
      </thead>
      <tbody id="appointmentsTable"></tbody>
    </table>
  </div>

  <script>
    // âœ… Persist appointments in LocalStorage
    let appointments = JSON.parse(localStorage.getItem("appointments")) || [];

    document.getElementById("appointmentBtn").onclick = function() {
      openModal("roleModal");
    };

    function openModal(id) { closeAllModals(); document.getElementById(id).style.display = "flex"; }
    function closeModal(id) { document.getElementById(id).style.display = "none"; }
    function closeAllModals() { document.querySelectorAll(".modal").forEach(m => m.style.display = "none"); }
    window.onclick = function(event) { document.querySelectorAll(".modal").forEach(modal => { if (event.target == modal) modal.style.display = "none"; }); }

    // Client form
    document.getElementById("clientForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const newAppointment = {
        date: new Date().toISOString().split("T")[0],
        name: document.getElementById("clientName").value,
        age: document.getElementById("clientAge").value,
        email: document.getElementById("clientEmail").value,
        category: document.getElementById("clientCategory").value,
        purpose: document.getElementById("clientPurpose").value
      };
      appointments.push(newAppointment);
      localStorage.setItem("appointments", JSON.stringify(appointments)); // save
      alert("Appointment Submitted!");
      this.reset();
      closeModal("clientModal");
    });

    // Admin login
    document.getElementById("adminLoginForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const user = document.getElementById("adminUser").value;
      const pass = document.getElementById("adminPass").value;
      if(user === "admin" && pass === "1234") {
        closeModal("adminModal");
        document.getElementById("adminDashboard").style.display = "block";
        renderTable();
      } else {
        alert("Invalid credentials!");
      }
    });

    function renderTable() {
      const tbody = document.getElementById("appointmentsTable");
      tbody.innerHTML = "";
      let filtered = appointments;
      const search = document.getElementById("searchBar").value.toLowerCase();
      const filterDate = document.getElementById("filterDate").value;
      const filterCategory = document.getElementById("filterCategory").value;
      if(search) filtered = filtered.filter(a => a.name.toLowerCase().includes(search) || a.email.toLowerCase().includes(search) || a.purpose.toLowerCase().includes(search));
      if(filterDate) filtered = filtered.filter(a => a.date === filterDate);
      if(filterCategory) filtered = filtered.filter(a => a.category === filterCategory);
      filtered.forEach(a => {
        tbody.innerHTML += `<tr><td>${a.date}</td><td>${a.name}</td><td>${a.age}</td><td>${a.email}</td><td>${a.category}</td><td>${a.purpose}</td></tr>`;
      });
    }

    document.getElementById("searchBar").addEventListener("input", renderTable);
    document.getElementById("filterDate").addEventListener("change", renderTable);
    document.getElementById("filterCategory").addEventListener("change", renderTable);
  </script>
</body>
</html>
